{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h1>⚖️ Сравнение товаров</h1>
    
    {% if products %}
    <div class="table-responsive">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Характеристика</th>
                    {% for product in products %}
                    <th>{{ product.name }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Цена</td>
                    {% for product in products %}
                    <td class="fw-bold text-success">{{ product.price }} ₽</td>
                    {% endfor %}
                </tr>
                <tr>
                    <td>Категория</td>
                    {% for product in products %}
                    <td>{{ product.category.name }}</td>
                    {% endfor %}
                </tr>
                <tr>
                    <td>Наличие</td>
                    {% for product in products %}
                    <td>
                        {% if product.available %}
                        <span class="badge bg-success">В наличии</span>
                        {% else %}
                        <span class="badge bg-warning">Нет в наличии</span>
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>
    
    <div class="mt-3">
        <a href="{% url 'comparison_toggle' products.0.id %}" class="btn btn-danger">Очистить сравнение</a>
    </div>
    {% else %}
    <div class="alert alert-info">
        <h4>Нет товаров для сравнения</h4>
        <p>Добавьте товары в сравнение чтобы увидеть различия!</p>
        <a href="{% url 'product_list' %}" class="btn btn-primary">Перейти в каталог</a>
    </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const totalItems = {{ products|length }};
    console.log('Comparison items:', totalItems);
    localStorage.setItem('comparisonCount', totalItems);
    
    const counter = document.getElementById('comparisonCounter');
    if (counter) {
        if (totalItems > 0) {
            counter.textContent = totalItems;
        } else {
            counter.textContent = '0';
        }
    }
});
</script>
{% endblock %}
