<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Техника - Список товаров</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .filters { background: #f5f5f5; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        .product { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
        .product h3 { margin-top: 0; }
        .product-details { color: #666; font-size: 0.9em; }
        .price { color: #2c5aa0; font-weight: bold; }
        .no-price { color: #999; }
    </style>
</head>
<body>
    <h1>Техника - Список товаров</h1>
    
    <div class="filters">
        <form method="get">
            <label for="category">Фильтр по категории:</label>
            <select name="category" id="category" onchange="this.form.submit()">
                <option value="">Все категории</option>
                {% for category in categories %}
                <option value="{{ category.code }}" {% if selected_category == category.code %}selected{% endif %}>
                    {{ category.name }} ({{ category.code }})
                </option>
                {% endfor %}
            </select>
        </form>
    </div>

    <div class="products">
        {% for product in products %}
        <div class="product">
            <h3>{{ product.name }}</h3>
            <div class="product-details">
                <p><strong>Артикул:</strong> {{ product.part_number }}</p>
                <p><strong>Производитель:</strong> {{ product.producer }}</p>
                <p><strong>Категория:</strong> {{ product.category.name }}</p>
                <p><strong>Наличие:</strong> {{ product.stock }} шт.</p>
                <p><strong>Цена:</strong> 
                    <span class="{% if product.price %}price{% else %}no-price{% endif %}">
                        {% if product.price %}{{ product.price }} руб.{% else %}Нет цены{% endif %}
                    </span>
                </p>
                {% if product.description %}
                <p><strong>Описание:</strong> {{ product.description|truncatewords:30 }}</p>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <p>Товары не найдены.</p>
        {% endfor %}
    </div>

    <p><a href="{% url 'appliances:category_list' %}">Посмотреть все категории</a></p>
    <p><small>Показано товаров: {{ products|length }}</small></p>
</body>
</html>
